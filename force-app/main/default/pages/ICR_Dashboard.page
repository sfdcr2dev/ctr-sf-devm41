<apex:page controller="ICR_DashboardController" standardStylesheets="true" lightningStylesheets="true" sidebar="false" showHeader="false" applyHtmlTag="true" applyBodyTag="false" docType="html-5.0" language="th">{!LanguageThai}
      
    <apex:stylesheet value="{!URLFOR($Resource.ICR_Dashboard, '/ICR_Dashboard/bootstrap.min.css')}"/>
    <apex:stylesheet value="{!URLFOR($Resource.ICR_Dashboard, '/ICR_Dashboard/bootstrap-datepicker3.standalone.min.css')}"/>
    <apex:stylesheet value="{!URLFOR($Resource.ICR_Dashboard, '/ICR_Dashboard/select2.min.css')}"/>
    <apex:stylesheet value="{!URLFOR($Resource.ICR_Dashboard, '/ICR_Dashboard/reset.css')}"/>
    <apex:stylesheet value="{!URLFOR($Resource.ICR_Dashboard, '/ICR_Dashboard/style.css')}"/>
    <apex:includeScript value="{!URLFOR($Resource.ICR_Dashboard, '/ICR_Dashboard/highcharts.min.js')}"/>
    <apex:includeScript value="{!URLFOR($Resource.ICR_Dashboard, '/ICR_Dashboard/jquery.min.js')}"/>
    <apex:includeScript value="{!URLFOR($Resource.ICR_Dashboard, '/ICR_Dashboard/kendo.all.min.js')}"/>
    <apex:includeScript value="{!URLFOR($Resource.ICR_Dashboard, '/ICR_Dashboard/bootstrap-datepicker.min.js')}"/>
    <apex:includeScript value="{!URLFOR($Resource.ICR_Dashboard, '/ICR_Dashboard/select2.min.js')}"/>
    
      <html lang="en">
        
        <head>
          <meta charset="utf-8"/>
          <meta http-equiv="X-UA-Compatible" content="IE=edge" />
          <meta name="viewport" content="width=device-width, initial-scale=1" />
          <title>Internal Committee Request (ICR) Dashboard</title>
          
          <style>
            body {
              background-color: #efefef;
              font-size: 10px;
              color: #000000;
              min-width: 1366px;
              font-family: 'SalesforceSans';
            }
            <!-- Body {
                font-family: 'SalesforceSans';
            }
            .ProjectLink {
                text-decoration : none;
            }
            .ProjectLink:hover {
                color: rgba(225,19,131,1);
            }
            .PagingButton {
                font-family: 'SalesforceSans';
                background-color :#0077d6;
            }
            .CustomFilterButton {
                padding: 6px;background: rgba(225,19,131,1);color: white;font-weight: 100;border: rgba(225,19,131,1);
            }
            @media only screen and (max-width: 768px) {
              ._section {
                padding: 10px;
              }
              ._box {
                padding: 16px;
              }
              ._search {
                display: block;
              }
              ._search-label {
                margin-bottom: 5px;
              }
              ._search .input {
                width: 100% !important;
              }
            } -->
          </style>
        </head>
        
        <body>
        <apex:form >
          
          <section class="section text-invert" id="page-title">
            <div class="is-flex is-between">
            
              <span class="text-size-large text-weight-bold">Internal Committee Request (ICR) Dashboard</span>
              
              <!-- <button class="text-size-normal text-weight-bold" id="new-request">
                <svg class="push-right-1" xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 16 16">
                  <path fill="#fff"
                    d="M16 3v10c0 1.7-1.3 3-3 3H3c-1.7 0-3-1.3-3-3V3c0-1.7 1.3-3 3-3h10c1.7 0 3 1.3 3 3zm-2.7 5.7V7.3c0-.4-.3-.7-.7-.7H9.3V3.3c0-.3-.3-.6-.6-.6H7.3c-.3 0-.6.3-.6.6v3.3H3.3c-.3.1-.6.4-.6.7v1.3c0 .4.3.7.6.7h3.3v3.3c0 .4.3.7.7.7h1.3c.4 0 .7-.3.7-.7V9.3h3.3c.4 0 .7-.3.7-.6z" />
                </svg>
              
                <span>New Request</span>
              </button> -->
              
              <a id="new-request" class="button text-size-normal text-weight-bold" style="color:white;text-decoration:none;" href="{!NewRequestURL}" targer="_parent" >
              <svg class="push-right-1" xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 16 16">
                  <path fill="#fff"
                    d="M16 3v10c0 1.7-1.3 3-3 3H3c-1.7 0-3-1.3-3-3V3c0-1.7 1.3-3 3-3h10c1.7 0 3 1.3 3 3zm-2.7 5.7V7.3c0-.4-.3-.7-.7-.7H9.3V3.3c0-.3-.3-.6-.6-.6H7.3c-.3 0-.6.3-.6.6v3.3H3.3c-.3.1-.6.4-.6.7v1.3c0 .4.3.7.6.7h3.3v3.3c0 .4.3.7.7.7h1.3c.4 0 .7-.3.7-.7V9.3h3.3c.4 0 .7-.3.7-.6z" />
                  
                <span>New Request</span>
              </svg></a>
              
              
            </div>
          </section>
          <section class="section text-size-normal">
            <div class="push-bottom-3 is-flex noExport">
              <div class="push-right-2">
                <div class="block">Request Date</div>
                <div class="is-flex is-align-center">
                  <div class="date-wrapper">
                    <input
                      type="text"
                      class="form-control"
                      id="start-date"
                    >
                    </input>
                    <svg
                      class="calendar-icon"
                      xmlns="http://www.w3.org/2000/svg"
                      width="16"
                      height="16"
                      viewBox="0 0 16 16"
                    >
                      <path
                        fill="#566d80"
                        d="M6 12H4v-2h2zm3-3H7V7h2zm3 0h-2V7h2zm-3 3H7v-2h2zm3 0h-2v-2h2zm1-10h2c.5 0 1 .4 1 .9V15c0 .5-.4 1-.9 1H1c-.5 0-1-.4-1-.9V3c0-.5.4-1 .9-1H3V1c0-.5.4-1 .9-1H4c.5 0 1 .4 1 .9V2h6V1c0-.6.4-1 1-1s1 .4 1 1zM2 5v9h12V5z"
                      />
                    </svg>
                  </div>
                  <span style="padding: 4px;">-</span>
                  <div class="date-wrapper">
                    <input
                      type="text"
                      class="form-control"
                      id="end-date"
                    />
                    <svg
                      class="calendar-icon"
                      xmlns="http://www.w3.org/2000/svg"
                      width="16"
                      height="16"
                      viewBox="0 0 16 16"
                    >
                      <path
                        fill="#566d80"
                        d="M6 12H4v-2h2zm3-3H7V7h2zm3 0h-2V7h2zm-3 3H7v-2h2zm3 0h-2v-2h2zm1-10h2c.5 0 1 .4 1 .9V15c0 .5-.4 1-.9 1H1c-.5 0-1-.4-1-.9V3c0-.5.4-1 .9-1H3V1c0-.5.4-1 .9-1H4c.5 0 1 .4 1 .9V2h6V1c0-.6.4-1 1-1s1 .4 1 1zM2 5v9h12V5z"
                      />
                    </svg>
                  </div>
                </div>
              </div>
        
              <div class="push-right-2">
                <div class="block">Workflow Status</div>
                <select
                  class="select is-fullwidth"
                  id="workflow-status"
                  style="width: 193px;"
                >
                  <option value="All">All</option>
                  <option value="notSubmit">Not Submit</option>
                  <option value="waitingRequesterRevise">Waiting Requester Revise</option>
                  <option value="waitingLineManagerApproval">Waiting Line Manager Approval</option>
                  <option value="waitingSubmitApprovalType">Waiting Submit Approval Type</option>
                  <option value="waitingGSCSApproval">Waiting GSCS Approval</option>
                  <option value="waitingRequesterUpdateResult">Waiting Requester Update Result</option>
                  <option value="waitingEVPApproval">Waiting EVP Approval</option>
                  <option value="waitingCircularNo">Waiting Circular No.</option>
                  <option value="waitingSignedCircularFile">Waiting Signed Circular File</option>
                  <option value="cancelledRequest">Cancelled Request</option>
                  <option value="appointed">Appointed</option>
                  <option value="disappointed">Disappointed</option>
                </select>
              </div>
        
              <div
                class="custom-select2-wrapper push-right-2"
                style="width: 204px;"
              >
                <div class="block">Requester</div>
                <select
                  id="requester"
                >
                <apex:repeat value="{!RequesterNames}" var="RN">
                    <option value="{!RN}">{!RN}</option>
                </apex:repeat>
                </select>
              </div>
        
              <div
                class="custom-select2-wrapper push-right-2"
                style="width: 193px;"
              >
                <div class="block">Committee Title</div>
                <select
                  id="committee-title"
                >
                <apex:repeat value="{!CommitteeTitles}" var="CT">
                    <option value="{!CT}">{!CT}</option>
                </apex:repeat>
                </select>
              </div>
        
              <div
                class="custom-select2-wrapper push-right-2"
                style="width: 132px;"
              >
                <div class="block">Document No.</div>
                <select
                  id="document-no"
                >
                    <apex:repeat value="{!DocNos}" var="DocNo">
                        <option value="{!DocNo}">{!DocNo}</option>
                    </apex:repeat>
                </select>
              </div>
        
              <div
                class="custom-select2-wrapper push-right-4"
                style="width: 108px;"
              >
                <div class="block">Circular No.</div>
                <select
                  id="circular-no"
                >
                <apex:repeat value="{!CircularNos}" var="CircularNo">
                    <option value="{!CircularNo}">{!CircularNo}</option>
                </apex:repeat>
                </select>
              </div>
        
              <div class="is-flex align-items-end">
                <button
                  class="form-button search push-right-1"
                  id="search"
                  type="button"
                >
                  <svg
                    xmlns="http://www.w3.org/2000/svg"
                    width="18"
                    height="18"
                    viewBox="0 0 18 18"
                  >
                    <path
                      fill="#fff"
                      d="M2.195 7.685a5.435 5.435 0 0 1 5.49-5.49 5.435 5.435 0 0 1 5.488 5.49 5.435 5.435 0 0 1-5.489 5.489 5.435 5.435 0 0 1-5.489-5.49zm15.26 8.233l-3.624-3.623a7.516 7.516 0 0 0 1.538-4.61A7.636 7.636 0 0 0 7.684 0 7.636 7.636 0 0 0 0 7.685a7.636 7.636 0 0 0 7.684 7.684 7.516 7.516 0 0 0 4.61-1.537l3.623 3.623z"
                    />
                  </svg>
                    <apex:actionFunction name="SearchFilter" action="{!FromSearch}" reRender="WholePage,graphScript" oncomplete="afterFilterSearch();" >
                        <apex:param assignTo="{!InputRequestStartDate}" name="RequestSD" value=""/>
                        <apex:param assignTo="{!InputRequestEndDate}" name="RequestED" value=""/>
                        <apex:param assignTo="{!WorkflowStatus}" name="WorkflowStatus" value=""/>
                        <apex:param assignTo="{!RequesterName}" name="RequesterName" value=""/>
                        <apex:param assignTo="{!CommitteeTitle}" name="CommitteeTitle" value=""/>
                        <apex:param assignTo="{!DocNo}" name="DocNo" value=""/>
                        <apex:param assignTo="{!CircularNo}" name="CircularNo" value=""/>
                    </apex:actionFunction>
                </button>
                
                <button
                  type="button"
                  class="form-button reset"
                  id="reset"
                >
                  <svg
                    xmlns="http://www.w3.org/2000/svg"
                    width="16"
                    height="16"
                    viewBox="0 0 16 16"
                  >
                    <path
                      d="M8.004 1.1c3.798 0 6.897 3.098 6.897 6.896s-3.099 6.896-6.897 6.896-6.796-3.098-6.796-6.896 2.998-6.897 6.796-6.897zM16 7.195C15.6 3.298 12.402.3 8.504 0h-.9C3.207.2-.192 3.998.008 8.395c.2 4.398 3.998 7.796 8.396 7.596 3.898-.2 7.096-3.298 7.496-7.196.1-.5.1-1.1.1-1.599z"
                    />
                    <path
                      d="M5.106 11.794l3.098-3.199 3.098 3.199.8-.9-2.998-3.298 3.098-3.199-.8-.899-3.198 3.298-3.098-3.298-.9.9 3.099 3.198-3.099 3.198z"
                    />
                  </svg>
                </button>
              </div>
            </div>
                
            <div id="TopSection">
                
            <apex:outputPanel id="WholePage">
                <div class="push-bottom-3">
                  <div class="is-flex">
                    <div class="boxes is-flex-1 push-right-4 summary">
                      <div class="box text-center total">
                        <div class="text-size-small title">TOTAL</div>
                        <div class="number">{!PNW.Total}</div>
                      </div>
                      <div class="box in-progress text-center">
                        <div class="text-size-small title">IN PROGRESS</div>
                        <div class="is-flex">
                          <div class="icon">
                            <svg xmlns="http://www.w3.org/2000/svg" width="22" height="28" viewBox="0 0 22 28">
                              <path fill="#fff"
                                d="M5.55 26.076c.7-2.975 4.725-6.125 5.25-6.475a.846.846 0 0 1 1.225 0c.525.35 4.375 3.5 5.25 6.475zm5.25-9.625c.35-.35 1.05-.35 1.4 0 .35.35.35 1.05 0 1.4-.35.35-1.05.35-1.4 0-.175-.35-.35-.525-.35-.7 0-.35.175-.525.35-.7zm-.35-6.125c0-.525.35-.875.875-.875s.875.35.875.875v1.75c0 .525-.35.875-.875.875s-.875-.35-.875-.875zm10.675 15.75h-1.75v-2.975c0-3.15-1.75-6.125-4.55-7.7-.35-.35-.7-.875-.7-1.4 0-.525.175-1.05.7-1.4 2.8-1.575 4.55-4.55 4.55-7.7V1.926h1.75c.525 0 .875-.35.875-.875s-.35-1.05-.875-1.05H1.875c-.7 0-1.05.35-1.05.875s.35.875.875.875h1.75v2.975c.175 3.15 1.925 6.125 4.55 7.7.525.525.7 1.05.7 1.575 0 .525-.175 1.05-.525 1.4-2.8 1.575-4.55 4.55-4.55 7.7v2.975h-1.75c-.525 0-.875.35-.875.875s.175 1.05.7 1.05h19.25c.525 0 .875-.35.875-.875s-.175-1.05-.7-1.05z" />
                            </svg>
                          </div>
                          <div class="number text-left">{!PNW.InProgress}</div>
                        </div>
                      </div>
                      <div class="box appointed text-center">
                        <div class="text-size-small title">APPOINTED</div>
                        <div class="is-flex">
                          <div class="icon">
                            <svg xmlns="http://www.w3.org/2000/svg" width="32" height="28" viewBox="0 0 32 28">
                              <path fill="#fff"
                                d="M11.123 9.888h.014c.244 0 .472.098.624.273l2.74 2.827 6.197-6.197a.888.888 0 0 1 1.278 0l1.277 1.274a.697.697 0 0 1 .365.638.826.826 0 0 1-.277.64l-6.836 6.839-1.277 1.277a.894.894 0 0 1-.639.274.896.896 0 0 1-.639-.274l-1.277-1.277-3.462-3.465a.69.69 0 0 1-.273-.64.814.814 0 0 1 .273-.638l1.273-1.278a.834.834 0 0 1 .623-.273zM4.816 28c1.844 0 5.63-.366 10.258-2.82.389.02.74.031 1.07.031 4.22 0 8.188-1.3 11.174-3.66 3.02-2.38 4.682-5.557 4.682-8.945 0-3.387-1.663-6.564-4.682-8.946C24.325 1.3 20.356 0 16.144 0 11.936 0 7.968 1.3 4.97 3.66 1.95 6.046.288 9.223.288 12.606c0 2.037.624 4.059 1.806 5.849 1.094 1.655 2.663 3.12 4.537 4.237-.096.658-.586 2.415-3.066 4.51a.415.415 0 0 0-.137.444c.048.163.188.281.357.305h.005l.016.003c.287.03.626.046 1.01.046z" />
                            </svg>
                          </div>
                          <div class="number text-left">{!PNW.Appointed}</div>
                        </div>
                      </div>
                      <div class="box disappointed text-center">
                        <div class="text-size-small title">DISAPPOINTED</div>
                        <div class="is-flex">
                          <div class="icon">
                            <svg xmlns="http://www.w3.org/2000/svg" width="32" height="28" viewBox="0 0 32 28">
                              <path fill="#fff"
                                d="M21.666 16.693l-1.61 1.61a.426.426 0 0 1-.604 0l-3.594-3.593-3.593 3.593a.427.427 0 0 1-.604 0l-1.61-1.61a.427.427 0 0 1 0-.604l3.593-3.594-3.593-3.593a.427.427 0 0 1 0-.604l1.61-1.61a.427.427 0 0 1 .604 0l3.593 3.593 3.594-3.593a.427.427 0 0 1 .604 0l1.61 1.61a.427.427 0 0 1 0 .604l-3.593 3.593 3.593 3.594a.427.427 0 0 1 0 .604zm5.369-13.034c-2.99-2.36-6.96-3.66-11.177-3.66S7.672 1.3 4.682 3.66C1.662 6.04 0 9.219 0 12.605c0 2.037.625 4.06 1.806 5.85 1.09 1.653 2.655 3.113 4.537 4.237-.087.608-.554 2.388-3.067 4.509a.427.427 0 0 0 .22.75c.015.002.38.049 1.03.049 1.852 0 5.636-.368 10.261-2.818.357.019.717.028 1.071.028 4.218 0 8.187-1.299 11.177-3.658 3.019-2.383 4.682-5.56 4.682-8.947 0-3.386-1.663-6.564-4.682-8.946z" />
                            </svg>
                          </div>
                          <div class="number text-left">{!PNW.Disappointed}</div>
                        </div>
                      </div>
                      <div class="box cancelled text-center">
                        <div class="text-size-small title">CANCELLED</div>
                        <div class="is-flex">
                          <div class="icon">
                            <svg xmlns="http://www.w3.org/2000/svg" width="28" height="28" viewBox="0 0 28 28">
                              <g>
                                <path fill="#fff"
                                  d="M14 25.675C7.564 25.675 2.325 20.436 2.325 14 2.325 7.564 7.564 2.325 14 2.325c6.436 0 11.675 5.239 11.675 11.675 0 6.436-5.239 11.675-11.675 11.675zM14 0C6.258 0 0 6.258 0 14s6.258 14 14 14 14-6.258 14-14S21.742 0 14 0z" />
                              </g>
                              <g>
                                <path fill="#fff"
                                  d="M20.316 8.079a1.206 1.206 0 0 0-1.667 0L14 12.438 9.356 8.084a1.206 1.206 0 0 0-1.666 0c-.475.446-.475 1.117 0 1.562L12.334 14 7.69 18.353c-.475.446-.492 1.133 0 1.562.372.323 1.076.559 1.666 0L14 15.562l4.644 4.353c.71.629 1.431.226 1.666 0 .475-.445.475-1.116 0-1.562L15.666 14l4.644-4.354c.481-.45.481-1.122.006-1.567z" />
                              </g>
                            </svg>
                          </div>
                          <div class="number text-left">{!PNW.Cancelled}</div>
                        </div>
                      </div>
                    </div>
                    <apex:outputPanel rendered="{!isMobileDisable == false}">
                    <div class="is-flex is-align-center">
                      <div class="push-right-2" style="display: inline-block">
                        <button type="button" class="export-button" id="export-excel">
                          <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="18" height="18"
                            viewBox="0 0 18 18">
                            <defs>
                              <image id="zwx8b" width="32" height="32"
                                xlink:href="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAABINJREFUWEfFll9MW3UUx7/nd1u4IIvgnyVIjNkb/omYbbqVQrm0XQk+qFnsg2ZvPmh0JgyabdGHybJkTJhols0/DxqjiQ9kPixmZoOWLoOS6NyGMTMmaqZxJooZoEAL9J5j7i2UDnprO2K4T7/f754/n3N+53d+P0KBLxQy6k3GBwCaC8kV+DfDGjUNnxsed5Ihpx9er3eTXqF9D6i623S+pMY3hF07YrHYjXx2HAECu4w9EHxiKRHQzazOiFtMa67SSpaNES1mx0qtrJsmPgJhuy0nuGqaaI7H4zOrIRwB/LuMAyToAeHL6GD8yVKz4Pf74qRUSxYUcramZvNTAwMDdhAr6w6Wg0HjoABHQXg/Ohh/ab0AGX05FR268MoGAlgM1BWNDr+VzUB5pLEnX3R3/Y2dlSmtZd4tVydq+FxpGVCj3suqK3cLlvWZhTWlwkNDw5/b9aVHvNkiKs2JszSRvLPzSlmDAgwHqaSwMmKx2FdZAEuJBan1QIiQTxE8lq3Gy2X3gRB2sscsf0oZ7cgC6Gl3zdTb8an1AOiRpiOAvG4BeMbdUWI6U9iefPu/ASR7Ex3BoHFEgNcyrWTtx8yzeQH0SKMfRE8sq6RU6l0c+2bamld2NT/DiuvtAoJwUqpOou/8rDXPzYAFYK2FQsYjpqCNBJtyEQTYz8ycF6Cyo7nWdKXHCepe25HgZPL46F53Z1ODpuRrAG7bGOFwqnf00LLhfABOWxAIGpPM7HbcgvIubzsRzi4ZEIgYxHRCNDyacS6Dqet17cjpbCUC/GMloGANlEe8vQREbIfMKSil20OTfivTaevM0YsTuRGWCDDnuAVZo4ceKtNna0YAPJ5dY06TIl+yLzG2Or2lALT6W+YBWfzPU6Dv97aCEcs6E/kwdTzxQr69LQ3AlwaQKgzwxrbKihl3QqA1rGQAC8oF79ybo5fWk4FA0BDHY7hkmPRO76dQeD5TA5iGwp32WHC93E1bp3tGJm+nBsLhsHZzciJdEKCiy7tPCJlbizEtwttF0z5WkMbMIZAvklWJp9ENLvUYhsPhspuTE/OFGxHkPKA02xnJs8nexGk94tsCNsehMk2FQAeTfSPHSgXweDwVlXeUW6dgbSfUuxofEMIlAt2TcSKnkn2J7CNCjzTuAch+qlkHEuQKpHovXrBmxRahYRhVmgtWH1gLULHPU0duVbsc1VyF+zt0x3NvSars9DwGVyY75iJPzfeP/VgiQLXmgtUJ898F+Y5YMWvFZiAQCNwNMv/aMIBQKLTZ5IU/bgEoJsJiZaz3wPJtmE+nra25Nm1qv28YQCjku99k9asNUN1hVOejfPgHedXNdHiBzM+u1WsvFxu9JTdF8/PoH0s66YRCvi0mq59tACchf9DYS8AJwPxlbjb94NiYs8FS4CzZQMB4EYT3GDztCNAaat2mWOx+L8AVIhkE0/pf0CS1AD1nPWoYiDsCWI79/pbTpGh3qREWKW8/zQsCtLe3ly+kUwdYpBUmXLmGlWYlZtUncsuarJrbnVUphuAnQOuPRqPX/gXM1aqrvFmy5AAAAABJRU5ErkJggg==" />
                              <clipPath id="zwx8a">
                                <path d="M0 18V0h18v18z" />
                              </clipPath>
                            </defs>
                            <g clip-path="url(&quot;#zwx8a&quot;)">
                              <use transform="scale(.5625)" xlink:href="#zwx8b" />
                            </g>
                          </svg>
                          <span>
                            <a href="{!ExportExcelURL}" target="_blank" style="text-decoration:none;color:black;">Export Excel</a>
                          </span>
                        </button>
                      </div>
                      <div style="display: inline-block">
                        <button type="button" class="export-button" id="export-pdf">
                          <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="18" height="18"
                            viewBox="0 0 18 18">
                            <defs>
                              <image id="pt8sb" width="32" height="32"
                                xlink:href="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAABKxJREFUWEfFl3tsU3UUx7/nd9u9nAiTjpFFZwxEVKIJBkk7trW9e1BWxJAgMv8wmhCNb8UYiZkwn4nR8PAZE5EYJcT5B2ZbpozOilsxqASDoPGREHmugzBEYH38zjHtsq2F3nLnYrx/9d7f95zf53ce9/QS8lzeRd7rVBJvElAPoCifNtcas/wpTAvC4fAJK1uyWvB6vaWGQ/8EGFUT3ThLL/i+pOTKuo6OjvO5/FgCmKb3XhC2pIwEtB5EXxgQnbrXRDLqjLQe/53xXGt8pAxcM6LjzxdW+5a1tbXxxRDWAA2+5yHSBkJ3qCe8eKJRMOvrfgHohjFQYMPOneEnbQPU13vXCbAWgo2hUPiJyQKMRBKP9u4Mv5XpyzIC/wUAM2tF6s5QKNw5Fplo0P1srtP1aao/LIZZAe73OXjMwE4kRMk3LecLP8hMwagdM58jOGp7e3v3pp5RNOgZKyI7zm1qWu8+X3APKczJqRccNwxesGPHrsPjAIItAopZbaBIDBZKd4FlT5PUArgRQOvKmDMAIY+VVhj7Y7FE9RiA01Ewbdr28FAug9PL/FU6NvwyJRxrrt6x67CV04Hm6veI5IEUQMuw84yANuWNGOEzWwAnmz0fMvOnyuGom97Rl7NmUhtlAjxcXPnqydODnyhghXXI5IAtgGizp12IQhChGV2Rd+1EoLwz8lJKZ5p1DVDKB5aSsconGAI8ArIJMBD0fAwhGMSbpnfu3jMRgFzaxsbGKzTH/7YP0Ox5CKQfKy++9mZqb7csxMwUjEYgF0AgEJgST1w4YxtgcIk7mGTZMLPr21n5isouQFNTU1lSx07ZB1jsbmHGXcpQG11d/V9NNgWBQI0rnjCitgB+CwQKr1J/hcq7+heeWOL+rqJj9/zJAni93grDgeO2AAaDnqcgOObqimw7ucgzn51Y6iqKrE2/RtuRVQ92U+D3+ytJ8ZHLApxpcpfFnLTVEHlBk5qnQDMSHG8mULFSdEBAJQKKFIl6e2pX3+kJAFSR4kN5AQYW1dwCxW8QSSUp2caCQyK0twjq6HABVyKBVUwFLzoSiTms5H7tdKx1JPVzo2/CfF1gmub1IP2HJcBA0LOOBFXCKCsvHVpO7QfjF+d9sLn6Dk1wg3krlFpgaCFWdJsdgIaG2tks6tdLAKY6XWcHLxzZTGR8qcEtFR2RYL62OxWouUkbeqUCML0z0mo3BY2N3jma8fMlAJrjq4ULjjINV5efLbqPwuGkzfGblk0AYK5m7L8E4BwlywvjsmKIp7w2u7vbcjRPtg19Tb5blZZ9WQBJKnDNPIuc49huFKKlw+8Q1KrUOM5XhH6/fx4p/iELwO4mNnV5AUyzbj6I9vyfAG4QRUYAlntLc53qwSF6JgZpdYpsfn8aPW7z5GmZC9F4rtYd9WGadTUg2pUGsHJsNnhXQ/A6Ab87ncVzu/9FUVr79r0CkTUQ+dESwO/3e0hxf9qJYB+ArzMdEqW+M7IvxvgnW9qMOEujmATEswC1dMRSNlsCpJbN+trt4+KJJOHyWmaJEozb8wIEAoHCWOLC0yRcw6SMTLcqRwRIJOvEctF9eoJS6q89HSRyru/p6Tn2D/3RhzNtA0/NAAAAAElFTkSuQmCC" />
                              <clipPath id="pt8sa">
                                <path d="M0 18V0h18v18z" />
                              </clipPath>
                            </defs>
                            <g clip-path="url(&quot;#pt8sa&quot;)">
                              <use transform="scale(.5625)" xlink:href="#pt8sb" />
                            </g>
                          </svg>
                          <span>
                            Export PDF
                          </span>
                        </button>
                      </div>
                    </div>
                    </apex:outputPanel>
                  </div>
                </div>
                
                <div class="is-flex is-align-center push-bottom-2">
                  <button type="button" class="push-right-2" id="collapse-expand-button">
                    <i class="triangle-down" style="display:block;"></i>
                  </button>
                  <span class="text-size-large text-weight-bold text-color">Committee Request Summary</span>
                </div>
                
                <div class="push-bottom-2 collapse show" id="committee-request-summary">
                <div class="boxes info">
                <div class="box is-flex-1" id="committee-request-status">
                  <div class="box-name">Committee Request Status</div>
                  <div class="row-wrapper header">
                    <div>Workflow Status</div>
                    <div>Requested</div>
                  </div>
                  <div class="row-wrapper all">
                    <div>All Internal Committee Request</div>
                    <div class="value is-clickable" data-workflow-status="all">{!CSWs[11].StatusCount}</div>
                  </div>
                  <div class="row-wrapper body in-progress line">
                    <div>Waiting Requester Revise</div>
                    <div class="value is-clickable" data-workflow-status="waitingRequesterRevise">{!CSWs[0].StatusCount}</div>
                  </div>
                  <div class="row-wrapper body in-progress line">
                    <div>Waiting Line Manager Approval</div>
                    <div class="value is-clickable" data-workflow-status="waitingLineManagerApproval">{!CSWs[1].StatusCount}</div>
                  </div>
                  <div class="row-wrapper body in-progress line">
                    <div>Waiting Submit Approval Type</div>
                    <div class="value is-clickable" data-workflow-status="waitingSubmitApprovalType">{!CSWs[2].StatusCount}</div>
                  </div>
                  <div class="row-wrapper body in-progress line">
                    <div>Waiting GSCS Approval</div>
                    <div class="value" data-workflow-status="waitingGSCSApproval">{!CSWs[3].StatusCount}</div>
                  </div>
                  <div class="row-wrapper body in-progress line">
                    <div>Waiting Requester Update Result</div>
                    <div class="value is-clickable" data-workflow-status="waitingRequesterUpdateResult">{!CSWs[4].StatusCount}</div>
                  </div>
                  <div class="row-wrapper body in-progress line">
                    <div>Waiting EVP Approval</div>
                    <div class="value is-clickable" data-workflow-status="waitingEVPApproval">{!CSWs[5].StatusCount}</div>
                  </div>
                  <div class="row-wrapper body in-progress line">
                    <div>Waiting Circular No.</div>
                    <div class="value" data-workflow-status="waitingCircularNo">{!CSWs[6].StatusCount}</div>
                  </div>
                  <div class="row-wrapper body in-progress">
                    <div>Waiting Signed Circular File</div>
                    <div class="value is-clickable" data-workflow-status="waitingSignedCircularFile">{!CSWs[7].StatusCount}</div>
                  </div>
                  <div class="row-wrapper body cancelled">
                    <div>Cancelled Request</div>
                    <div class="value is-clickable" data-workflow-status="cancelledRequest">{!CSWs[8].StatusCount}</div>
                  </div>
                  <div class="row-wrapper body appointed">
                    <div>Appointed</div>
                    <div class="value is-clickable" data-workflow-status="appointed">{!CSWs[9].StatusCount}</div>
                  </div>
                  <div class="row-wrapper body disappointed">
                    <div>Disappointed</div>
                    <div class="value is-clickable" data-workflow-status="disappointed">{!CSWs[10].StatusCount}</div>
                  </div>
                </div>
        
                <div class="box is-flex-1">
                  <div class="box-name">Committee Approval Type</div>
                  <div id="committee-approval-chart"></div>
                </div>
        
                <div class="box" id="number-of-committee">
                  <div class="box-name">Number of Committee</div>
                  <div id="number-of-committee-chart"></div>
                </div>
              </div>
            </div>
        
                <div id="box" class="box">
                    <apex:outputPanel id="ICRTable">
                        <table id="data-table">
                            <thead>
                                <tr>
                                    <th id="DocumentNoTH" class="sort {!sortByDocumentNoHeader}" data-column="docNo">Document<br/>No.
                                        <apex:actionFunction name="DocNoSort" action="{!sortByDocumentNo}" reRender="ICRTable">
                                            <apex:param assignTo="{!sortByDocumentNoDesc}" name="sortByDocumentNoDesc" value=""/>
                                        </apex:actionFunction>
                                    </th>
                                    
                                    <th id="WorkflowStatusTH" width="240" class="sort {!sortByWorkflowStatusHeader}" data-column="workflowStatus">Workflow<br/>Status
                                        <apex:actionFunction name="WorkflowStatusSort" action="{!sortByWorkflowStatus}" reRender="ICRTable">
                                            <apex:param assignTo="{!sortByWorkflowStatusDesc}" name="sortByWorkflowStatusDesc" value=""/>
                                        </apex:actionFunction>
                                    </th>
                                    
                                    <th id="CommitteeTitleTH" class="sort {!sortByCommitteeTitleHeader}" data-column="committeeTitle">Committee<br/>Title
                                        <apex:actionFunction name="CommitteeTitleSort" action="{!sortByCommitteeTitle}" reRender="ICRTable">
                                            <apex:param assignTo="{!sortByCommitteeTitleDesc}" name="sortByCommitteeTitleDesc" value=""/>
                                        </apex:actionFunction>
                                    </th>
                                    
                                    <th id="ApprovalTypeTH" class="sort {!sortByApprovalTypeHeader}" data-column="approvalType">Approval<br/>Type
                                        <apex:actionFunction name="ApprovalTypeSort" action="{!sortByApprovalType}" reRender="ICRTable">
                                            <apex:param assignTo="{!sortByApprovalTypeDesc}" name="sortByApprovalTypeDesc" value=""/>
                                        </apex:actionFunction>
                                    </th>
                                    
                                    <th id="RequesterTH" class="sort {!sortByRequesterHeader}" data-column="requester">Requester
                                        <apex:actionFunction name="RequesterSort" action="{!sortByRequester}" reRender="ICRTable">
                                            <apex:param assignTo="{!sortByRequesterDesc}" name="sortByRequesterDesc" value=""/>
                                        </apex:actionFunction>
                                    </th>
                                    
                                    <th id="CircularNoTH" class="sort {!sortByCircularNoHeader}" data-column="circularNo">Circular<br/>No.
                                        <apex:actionFunction name="CircularNoSort" action="{!sortByCircularNo}" reRender="ICRTable">
                                            <apex:param assignTo="{!sortByCircularNoDesc}" name="sortByCircularNoDesc" value=""/>
                                        </apex:actionFunction>
                                    </th>
                                    
                                    <th id="RequestDateTH" class="sort {!sortByRequestDateHeader}" data-column="requestDate">Request<br/>Date
                                        <apex:actionFunction name="RequestDateSort" action="{!sortByRequestDate}" reRender="ICRTable">
                                            <apex:param assignTo="{!sortByRequestDateDesc}" name="sortByRequestDateDesc" value=""/>
                                        </apex:actionFunction>
                                    </th>
                                    
                                    <th id="EffectiveStartDateTH" class="sort {!sortByEffectiveStartDateHeader}" data-column="effectiveStartDate">Effective<br/>Start Date
                                        <apex:actionFunction name="EffectiveStartDateSort" action="{!sortByEffectiveStartDate}" reRender="ICRTable">
                                            <apex:param assignTo="{!sortByEffectiveStartDateDesc}" name="sortByEffectiveStartDateDesc" value=""/>
                                        </apex:actionFunction>
                                    </th>
                                    
                                    <th id="EffectiveEndDateTH" class="sort {!sortByEffectiveEndDateHeader}" data-column="effectiveEndDate">Effective<br/>End Date
                                        <apex:actionFunction name="EffectiveEndDateSort" action="{!sortByEffectiveEndDate}" reRender="ICRTable">
                                            <apex:param assignTo="{!sortByEffectiveEndDateDesc}" name="sortByEffectiveEndDateDesc" value=""/>
                                        </apex:actionFunction>
                                    </th>
                                    
                                    <th id="FinishedDateTH" class="sort {!sortByFinishedDateHeader}" data-column="finishedDate">Finished<br/>Date
                                        <apex:actionFunction name="FinishedDateSort" action="{!sortByFinishedDate}" reRender="ICRTable">
                                            <apex:param assignTo="{!sortByFinishedDateDesc}" name="sortByFinishedDateDesc" value=""/>
                                        </apex:actionFunction>
                                    </th>
                                    
                                    <th id="ActiveStatusTH" class="sort {!sortByActiveStatusHeader}" data-column="activeCommitteeStatus">Active<br/>Committee<br/>Status
                                        <apex:actionFunction name="ActiveStatusSort" action="{!sortByActiveStatus}" reRender="ICRTable">
                                            <apex:param assignTo="{!sortByActiveStatusDesc}" name="sortByActiveStatusDesc" value=""/>
                                        </apex:actionFunction>
                                    </th>
                                    
                                    <th>Approval<br/>History</th>
                                </tr>
                            </thead>
                            
                            <tbody>
                                
                                <apex:repeat value="{!ICRTWs}" var="ICR">
                                    <tr>
                                        <td><a class="text-link" href="{!ICR.DocumentLink}" target="_blank"><apex:outputText value="{!ICR.DocumentNo}"></apex:outputText></a></td>
                                        <td class="workflow-status {!ICR.ButtonStatus}">{!ICR.WorkflowStatus}</td>
                                        <td>{!ICR.CommitteeTitle}</td>
                                        <td>{!ICR.ApprovalType}</td>
                                        <td>{!ICR.RequesterName}</td>
                                        <td>{!ICR.CircularNo}</td>
                                        <td>
                                            <apex:outputText value="{0,date,dd/MM/yy}"> 
                                                <apex:param value="{!ICR.RequestDate}" /> 
                                            </apex:outputText>
                                        </td>
                                        <td>
                                            <apex:outputText value="{0,date,dd/MM/yy}"> 
                                                <apex:param value="{!ICR.EffectiveStartDate}" /> 
                                            </apex:outputText>
                                        </td>
                                        <td>
                                            <apex:outputText value="{0,date,dd/MM/yy}"> 
                                                <apex:param value="{!ICR.EffectiveEndDate}" /> 
                                            </apex:outputText>
                                            <apex:outputPanel rendered="{!ICR.EffectiveEndDate == null}">
                                                <apex:outputText value="จนกว่าจะมีคำสั่งเปลี่ยนแปลง" />
                                            </apex:outputPanel>
                                        </td>
                                        <td>
                                            <apex:outputText value="{0,date,dd/MM/yy}"> 
                                                <apex:param value="{!ICR.FinishedDate}" /> 
                                            </apex:outputText>
                                        </td>
                                        <td>
                                            <apex:outputText value="{!ICR.ActiveStatus}"> 
                                            </apex:outputText>
                                        </td>
                                        <td class="text-center">
                                            <a href="{!ICR.ApprovalHistoryLink}" target="_blank">
                                                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 16 16">
                                                    <path fill="#484848"
                                                          d="M7 5v3.414l2.293 2.293a1 1 0 0 0 1.414-1.414L9 7.586V5a1 1 0 1 0-2 0zM10.697.468A8 8 0 0 0 2.55 2.144l-.842-.842C1.077.672 0 1.118 0 2.01V6h3.99c.892 0 1.338-1.077.708-1.707l-.733-.733a6 6 0 1 1-1.383 7.019 1 1 0 1 0-1.805.86 8 8 0 1 0 9.92-10.97z" />
                                                </svg>
                                            </a>
                                        </td>
                                    </tr>
                                </apex:repeat>
                            </tbody>
                        </table>
                    </apex:outputPanel>
                </div>
            </apex:outputPanel>
                
            </div>
          </section>
      </apex:form>
        
          <script>
              
            $( window ).ready(function() {
                loadFilter();
                graphData();
            });
            
              
            function doSearch() {
            
                  const selectedStartDate = $('#start-date').datepicker('getDate').getTime() - timezoneOffset;
                  const selectedEndDate = $('#end-date').datepicker('getDate').getTime() - timezoneOffset;
                  const startDate = new Date(selectedStartDate).toISOString().split('.')[0] + 'Z';
                  const endDate = new Date(selectedEndDate).toISOString().split('.')[0] + 'Z';
            
                  const workflowStatus = $('#workflow-status').val();
                  const requester = $('#requester').select2('data');
                  const committeeTitle = $('#committee-title').select2('data');
                  const documentNo = $('#document-no').select2('data');
                  const circularNo = $('#circular-no').select2('data');
                  
                let sd = startDate;
                let ed = endDate;
                let ws = workflowStatus;
                let re = requester[0].id;
                let ct = committeeTitle[0].id;
                let dn = documentNo[0].id;
                let cn = circularNo[0].id;
                
                console.log(sd);
                console.log(ed);
                console.log(ws);
                console.log(re);
                console.log(ct);
                console.log(dn);
                console.log(cn);
                
                SearchFilter(sd,ed,ws,re,ct,dn,cn);
            }
          
            // NOTE: Only required if the Kendo UI stylesheets are loaded
            // from a different origin, e.g. cdn.kendostatic.com
            kendo.pdf.defineFont({
              "SalesforceSans": "./font/SalesforceSans-Regular.ttf",
              "SalesforceSans|Bold": "./font/SalesforceSans-Bold.ttf",
            });
          </script>
        
          <!-- datepicker -->
          <script>
            $('#start-date, #end-date').datepicker({
              format: "dd/mm/yyyy",
              todayHighlight: true,
              autoclose: true,
            });
            // set default date
            function setDefaultDate() {
              const startDate = new Date(new Date().getFullYear(), 0, 1);
              const endDate = new Date();
              $('#start-date').datepicker('update', startDate)
              $('#start-date').datepicker('setEndDate', endDate);
              $('#end-date').datepicker('update', endDate);
              $('#end-date').datepicker('setStartDate', startDate);
            }
            setDefaultDate();
          
            // handle on date change
            $('#start-date').datepicker().on('changeDate', function(e) {
              $('#end-date').datepicker('setStartDate', e.date);
            });
            $('#end-date').datepicker().on('changeDate', function(e) {
              $('#start-date').datepicker('setEndDate', e.date);
            });
        
            // click calendar icon
            $('.calendar-icon').on('click', function() {
              $(this).parent().find('input').focus();
            });
          </script>
        
          <!-- select2 -->
          <script>
          
              function loadFilter() {
              
                  $('#requester, #committee-title, #document-no, #circular-no').select2({ width: '100%' });
                    // $('#requester, #committee-title, #document-no, #circular-no').on('select2:selecting', function (e) {
                    //   const selectingOption = e.params.args.data;
                    //   // can select only 1 option
                    //   if ($(e.target).select2('data').length === 1) {
                    //     $(e.target).val(selectingOption.id).trigger('change');
                    //   }
                    // });
                    $('#requester').on('select2:select', function (e) {
                      console.log('on select', e.params.data);
                    });
                    // $('#requester, #committee-title, #document-no, #circular-no').on('select2:select', function (e) {
                    //   $(e.target).next().find('textarea').blur();
                    // });
              
              }
          
          </script>
        
          <!-- chart -->
          <apex:outputPanel id="graphScript">
          
          <script>
          
            function graphData() {
            
                const committeeApprovalChart = Highcharts.chart('committee-approval-chart', {
                  chart: {
                    type: 'column',
                  },
                  credits: {
                    enabled: false,
                  },
                  title: {
                    text: undefined,
                  },
                  xAxis: {
                    categories: ['AMM', 'CEO', 'Other', 'Waiting<br>Submit<br>Type'],
                    labels: {
                      style: {
                        color: '#484848',
                        fontSize: '1.2rem',
                        fontWeight: '700',
                        // fontFamily: 'SalesforceSans',
                      },
                    },
                  },
                  yAxis: {
                    min: 0,
                    title: {
                      text: undefined,
                    },
                    lineWidth: 1,
                    gridLineWidth: 0,
                    labels: {
                      style: {
                        color: '#484848',
                        fontSize: '1.2rem',
                        fontWeight: '700',
                        // fontFamily: 'SalesforceSans',
                      },
                    },
                  },
                  legend: {
                    verticalAlign: 'top',
                    layout: 'horizontal',
                    itemStyle: {
                      color: '#989898',
                      fontSize: '1.1rem',
                      fontWeight: '700',
                      // fontFamily: 'SalesforceSans',
                    },
                  },
                  plotOptions: {
                    column: {
                      pointWidth: 42,
                      stacking: 'normal',
                      dataLabels: {
                        padding: 0,
                        enabled: true,
                        formatter() {
                          if (this.y !== 0) {
                            return this.y;
                          }
                        },
                        style: {
                          fontWeight: '700',
                          // fontFamily: 'SalesforceSans',
                          fontSize: '1.8rem',
                          textOutline: 'none',
                          color: '#ffffff',
                        },
                      },
                    },
                  },
                  series: [{
                    name: 'Inprogress',
                    color: '#ffb610',
                    data: [{!CATWs[0].InProgress}, {!CATWs[1].InProgress}, 0, {!CATWs[3].InProgress}],
                  }, {
                    name: 'Appointed',
                    color: '#58b450',
                    data: [{!CATWs[0].Appointed}, {!CATWs[1].Appointed}, 0, 0],
                  }, {
                    name: 'Disappointed',
                    color: '#46579d',
                    data: [{!CATWs[0].Disappointed}, 0, {!CATWs[2].Disappointed}, 0]
                  }],
                });
            
                const calculateLabelDistance = (value) => {
                  if (value === 0) {
                    return {
                      enabled: false,
                    };
                  } else if (value === 100) {
                    return {
                      enabled: true,
                      distance: '-100%',
                    };
                  } else {
                    return {
                      enabled: true,
                      distance: '-50%',
                    };
                  }
                };
            
                const pieData = [
                  {
                    name: 'Active Committee',
                    y: {!NOCW.Active},
                    color: '#42c3bd',
                  },
                  {
                    name: 'Expired Committee',
                    y: {!NOCW.Expired},
                    color: '#f57a42',
                  },
                ];
            
                const numberOfCommitteeChart = Highcharts.chart('number-of-committee-chart', {
                  chart: {
                    type: 'pie',
                    plotBackgroundColor: null,
                    plotBorderWidth: null,
                    plotShadow: false,
                  },
                  credits: {
                    enabled: false,
                  },
                  title: {
                    text: undefined,
                  },
                  plotOptions: {
                    pie: {
                      size: 204,
                      showInLegend: true,
                      allowPointSelect: true,
                      cursor: 'pointer',
                      dataLabels: {
                        enabled: true,
                        format: '{point.y}',
                        style: {
                          color: '#ffffff',
                          fontSize: '2.4rem',
                          // fontFamily: 'SalesforceSans',
                          textOutline: 'none',
                          fontWeight: '700',
                        },
                      },
                    },
                  },
                  series: [{
                    type: 'pie',
                    colorByPoint: true,
                    data: pieData.map(v => ({ ...v, dataLabels: calculateLabelDistance(v.y) }))
                  }],
                  legend: {
                    itemStyle: {
                      color: '#989898',
                      fontSize: '1.2rem',
                      fontWeight: '700',
                      // fontFamily: 'SalesforceSans',
                    },
                    layout: 'horizontal',
                    verticalAlign: 'top',
                  },
                });
            }
          
            // set chart data
            // Committee Approval Type Chart
            // committeeApprovalChart.series[0].setData([5, 5, 5, 5]);
        
            // Number of Committee Chart
            // const pieData2 = [
            //     {
            //       name: 'Active Committee',
            //       y: 10,
            //       color: '#42c3bd',
            //     },
            //     {
            //       name: 'Expired Committee',
            //       y: 4,
            //       color: '#f57a42',
            //     },
            //   ];
            //   numberOfCommitteeChart.series[0].setData(
            //     pieData2.map(v => ({ ...v, dataLabels: calculateLabelDistance(v.y) }))
            //   );
        
              function afterFilterSearch() {
                    loadFilter();
                    graphData();
                }
        
          </script>
          </apex:outputPanel>
        
          <!-- handle event -->
          <script>
            $('#TopSection').on('click', '#committee-request-status .value', function() {
            <!-- $('#committee-request-status .value').on('click', function() { -->
              var clickStatus = $(this).data().workflowStatus;
              console.log('data', clickStatus);

              const timezoneOffset = new Date().getTimezoneOffset() * 60 * 1000;
              
                console.log('status click');
                const selectedStartDate = $('#start-date').datepicker('getDate').getTime() - timezoneOffset;
                const selectedEndDate = $('#end-date').datepicker('getDate').getTime() - timezoneOffset;
                const startDate = new Date(selectedStartDate).toISOString().split('.')[0] + 'Z';
                const endDate = new Date(selectedEndDate).toISOString().split('.')[0] + 'Z';
        
                const workflowStatus = $('#workflow-status').val();
                const requester = $('#requester').select2('data');
                const committeeTitle = $('#committee-title').select2('data');
                const documentNo = $('#document-no').select2('data');
                const circularNo = $('#circular-no').select2('data');
        
                let sd = startDate;
                let ed = endDate;
                let ws = clickStatus;
                let re = 'All';
                let ct = 'All';
                let dn = 'All';
                let cn = 'All';
                
                console.log('startDate:', sd);
                console.log('endDate:', ed);
                console.log('workflowStatus:', ws);
                console.log('requester:', re);
                console.log('committeeTitle:', ct);
                console.log('documentNo:', dn);
                console.log('circularNo:', cn);
              
                SearchFilter(sd,ed,ws,re,ct,dn,cn);
              
            });
        
            $(document).on('click', '.sort', function() {
              console.log('sort click');
              $('.sort').not(this).removeClass('asc desc');
              let sort = 'desc';
              
              let headerId = $(this).prop('id');
              
              if ($(this).hasClass('desc')) {
                $(this).removeClass('desc');
                $(this).addClass('asc');
                sort = 'asc';
                
                if(headerId == 'DocumentNoTH') {
                    DocNoSort(false);
                }
                else if(headerId == 'WorkflowStatusTH') {
                    WorkflowStatusSort(false);
                }
                else if(headerId == 'CommitteeTitleTH') {
                    CommitteeTitleSort(false);
                }
                else if(headerId == 'ApprovalTypeTH') {
                    ApprovalTypeSort(false);
                }
                else if(headerId == 'RequesterTH') {
                    RequesterSort(false);
                }
                else if(headerId == 'CircularNoTH') {
                    CircularNoSort(false);
                }
                else if(headerId == 'RequestDateTH') {
                    RequestDateSort(false);
                }
                else if(headerId == 'EffectiveStartDateTH') {
                    EffectiveStartDateSort(false);
                }
                else if(headerId == 'EffectiveEndDateTH') {
                    EffectiveEndDateSort(false);
                }
                else if(headerId == 'FinishedDateTH') {
                    FinishedDateSort(false);
                }
                else if(headerId == 'ActiveStatusTH') {
                    ActiveStatusSort(false);
                }
                
              } else if ($(this).hasClass('asc')) {
                $(this).removeClass('asc');
                $(this).addClass('desc');
                
                if(headerId == 'DocumentNoTH') {
                    DocNoSort(true);
                }
                else if(headerId == 'WorkflowStatusTH') {
                    WorkflowStatusSort(true);
                }
                else if(headerId == 'CommitteeTitleTH') {
                    CommitteeTitleSort(true);
                }
                else if(headerId == 'ApprovalTypeTH') {
                    ApprovalTypeSort(true);
                }
                else if(headerId == 'RequesterTH') {
                    RequesterSort(true);
                }
                else if(headerId == 'CircularNoTH') {
                    CircularNoSort(true);
                }
                else if(headerId == 'RequestDateTH') {
                    RequestDateSort(true);
                }
                else if(headerId == 'EffectiveStartDateTH') {
                    EffectiveStartDateSort(true);
                }
                else if(headerId == 'EffectiveEndDateTH') {
                    EffectiveEndDateSort(true);
                }
                else if(headerId == 'FinishedDateTH') {
                    FinishedDateSort(true);
                }
                else if(headerId == 'ActiveStatusTH') {
                    ActiveStatusSort(true);
                }
                
              } else {
                $(this).addClass('desc');
                if(headerId == 'DocumentNoTH') {
                    DocNoSort(false);
                } 
                else if(headerId == 'WorkflowStatusTH') {
                    WorkflowStatusSort(false);
                }
                else if(headerId == 'CommitteeTitleTH') {
                    CommitteeTitleSort(false);
                }
                else if(headerId == 'ApprovalTypeTH') {
                    ApprovalTypeSort(false);
                }
                else if(headerId == 'RequesterTH') {
                    RequesterSort(false);
                }
                else if(headerId == 'CircularNoTH') {
                    CircularNoSort(false);
                }
                else if(headerId == 'RequestDateTH') {
                    RequestDateSort(false);
                }
                else if(headerId == 'EffectiveStartDateTH') {
                    EffectiveStartDateSort(false);
                }
                else if(headerId == 'EffectiveEndDateTH') {
                    EffectiveEndDateSort(false);
                }
                else if(headerId == 'FinishedDateTH') {
                    FinishedDateSort(false);
                }
                else if(headerId == 'ActiveStatusTH') {
                    ActiveStatusSort(false);
                }
              }
        
              console.log('sort:', $(this).data().column);
              console.log('sort direction:', sort);
            });
        
            $('#export-excel').on('click', function() {
              console.log('exportExcel');
            });
        
            $('#TopSection').on('click', '#export-pdf', function() {
              kendo.drawing.drawDOM($("body"))
                .then(function (group) {
                  // Render the result as a PDF file
                  return kendo.drawing.exportPDF(group, {
                    paperSize: "auto",
                    forcePageBreak: '.pagebreak',
                    keepTogether: '.datatable-row-wrapper',
                    margin: { left: "1cm", top: "1cm", right: "1cm", bottom: "1cm" },
                    multiline: true,
                    // paperSize: "A4",
                    // scale: 0.4,
                    // landscape: true,
                  });
                })
                .done(function (data) {
                  // Save the PDF file
                  kendo.saveAs({
                    dataURI: data,
                    fileName: "icr-dashboard.pdf",
                    // proxyURL: "https://demos.telerik.com/kendo-ui/service/export"
                  });
                });
            });
        
            $('#workflow-status').on('change', function(e) {
              console.log('change', e.target.value);
            });
        
            const timezoneOffset = new Date().getTimezoneOffset() * 60 * 1000;
        
            $('#search').on('click', function() {
            
                const timezoneOffset = new Date().getTimezoneOffset() * 60 * 1000;
              
                console.log('search click');
                const selectedStartDate = $('#start-date').datepicker('getDate').getTime() - timezoneOffset;
                const selectedEndDate = $('#end-date').datepicker('getDate').getTime() - timezoneOffset;
                const startDate = new Date(selectedStartDate).toISOString().split('.')[0] + 'Z';
                const endDate = new Date(selectedEndDate).toISOString().split('.')[0] + 'Z';
        
                const workflowStatus = $('#workflow-status').val();
                const requester = $('#requester').select2('data');
                const committeeTitle = $('#committee-title').select2('data');
                const documentNo = $('#document-no').select2('data');
                const circularNo = $('#circular-no').select2('data');
        
                let sd = startDate;
                let ed = endDate;
                let ws = workflowStatus;
                let re = requester[0].id;
                let ct = committeeTitle[0].id;
                let dn = documentNo[0].id;
                let cn = circularNo[0].id;
                
                console.log('startDate:', sd);
                console.log('endDate:', ed);
                console.log('workflowStatus:', ws);
                console.log('requester:', re);
                console.log('committeeTitle:', ct);
                console.log('documentNo:', dn);
                console.log('circularNo:', cn);
              
                SearchFilter(sd,ed,ws,re,ct,dn,cn);
            
            });
            $('#reset').on('click', function() {
              console.log('reset');
              setDefaultDate();
              $('#workflow-status').val('All');
              $('#requester').val('All').trigger('change');
              $('#committee-title').val('All').trigger('change');
              $('#document-no').val('All').trigger('change');
              $('#circular-no').val('All').trigger('change');
            });
            
            $(document).on('click', '#new-request', function () {
              console.log('new request');
            });
            
            const committeeRequestSummaryHeight = $('#committee-request-summary').height();
            $('#TopSection').on('click', '#collapse-expand-button', function () {
              if ($('#committee-request-summary').hasClass('collapsing')) {
                return;
              }
              const isShow = $('#committee-request-summary').hasClass('show');
              const removeClasses = isShow ? 'collapse show' : 'collapse';
              const addClasses = isShow ? 'collapse' : 'collapse show';
              $('#committee-request-summary').removeClass(removeClasses)
                .css('height', isShow ? committeeRequestSummaryHeight : 0)
                .addClass('collapsing');
              setTimeout(() => {
                $('#committee-request-summary').css('height', isShow ? 0 : committeeRequestSummaryHeight);
                $('#collapse-expand-button').toggleClass('is-collapse');
              });
              setTimeout(() => {
                $('#committee-request-summary').removeClass('collapsing').addClass(addClasses);
              }, 350);
            });
        
          </script>
        </body>
    </html>
  
</apex:page>